<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Flugsuche</ion-title>
  </ion-toolbar>
  <div class="map-container">
    <iframe
      class="map-iframe"
      src="https://www.openstreetmap.org/export/embed.html?bbox=10.0%2C50.0%2C11.0%2C51.0&amp;layer=mapnik"
      allowfullscreen
      loading="lazy"
    ></iframe>
  </div>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="background-container">
    <img src="./assets/Background.png" alt="Hintergrundbild" class="background-image" />
  </div>

  <div class="flight-info">
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          {{selectedDeparture?.iata}} → {{selectedArrival?.iata}}
        </ion-card-title>
        <ion-card-subtitle>
          Abflug: {{departureDate | date:'dd.MM.yyyy'}}
          <span *ngIf="returnDate">
            | Rückflug: {{returnDate | date:'dd.MM.yyyy'}}
          </span>
        </ion-card-subtitle>
      </ion-card-header>
    </ion-card>

    <ion-list *ngIf="flights.length > 0">
      <ion-list-header>
        <ion-label>Hinflüge</ion-label>
      </ion-list-header>
      <ion-item *ngFor="let flight of flights">
        <ion-label>
          <h2>{{flight.number}} - {{flight.airline?.name || 'Unbekannt'}}</h2>
          <p>Abflug: {{flight.departure.scheduledTime | date:'HH:mm'}}</p>
          <p>Ankunft: {{flight.arrival?.airport?.name || 'Unbekannt'}}</p>
        </ion-label>
      </ion-item>
    </ion-list>

    <ion-list *ngIf="returnFlights.length > 0">
      <ion-list-header>
        <ion-label>Rückflüge</ion-label>
      </ion-list-header>
      <ion-item *ngFor="let flight of returnFlights">
        <ion-label>
          <h2>{{flight.number}} - {{flight.airline?.name || 'Unbekannt'}}</h2>
          <p>Abflug: {{flight.departure.scheduledTime | date:'HH:mm'}}</p>
          <p>Ankunft: {{flight.arrival?.airport?.name || 'Unbekannt'}}</p>
        </ion-label>
      </ion-item>
    </ion-list>

    <div *ngIf="isLoading" class="loading-spinner">
      <ion-spinner name="crescent"></ion-spinner>
    </div>

    <ion-text *ngIf="!isLoading && flights.length === 0" color="medium">
      Keine Flüge gefunden
    </ion-text>
  </div>
</ion-content>
